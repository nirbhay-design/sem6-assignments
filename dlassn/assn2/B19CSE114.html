<!DOCTYPE html>
<html>
<head>
<title>B19CSE114.md</title>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8">

<style>
/* https://github.com/microsoft/vscode/blob/master/extensions/markdown-language-features/media/markdown.css */
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

body {
	font-family: var(--vscode-markdown-font-family, -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif);
	font-size: var(--vscode-markdown-font-size, 14px);
	padding: 0 26px;
	line-height: var(--vscode-markdown-line-height, 22px);
	word-wrap: break-word;
}

#code-csp-warning {
	position: fixed;
	top: 0;
	right: 0;
	color: white;
	margin: 16px;
	text-align: center;
	font-size: 12px;
	font-family: sans-serif;
	background-color:#444444;
	cursor: pointer;
	padding: 6px;
	box-shadow: 1px 1px 1px rgba(0,0,0,.25);
}

#code-csp-warning:hover {
	text-decoration: none;
	background-color:#007acc;
	box-shadow: 2px 2px 2px rgba(0,0,0,.25);
}

body.scrollBeyondLastLine {
	margin-bottom: calc(100vh - 22px);
}

body.showEditorSelection .code-line {
	position: relative;
}

body.showEditorSelection .code-active-line:before,
body.showEditorSelection .code-line:hover:before {
	content: "";
	display: block;
	position: absolute;
	top: 0;
	left: -12px;
	height: 100%;
}

body.showEditorSelection li.code-active-line:before,
body.showEditorSelection li.code-line:hover:before {
	left: -30px;
}

.vscode-light.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(0, 0, 0, 0.15);
}

.vscode-light.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(0, 0, 0, 0.40);
}

.vscode-light.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-dark.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 255, 255, 0.4);
}

.vscode-dark.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 255, 255, 0.60);
}

.vscode-dark.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-high-contrast.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 160, 0, 0.7);
}

.vscode-high-contrast.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 160, 0, 1);
}

.vscode-high-contrast.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

img {
	max-width: 100%;
	max-height: 100%;
}

a {
	text-decoration: none;
}

a:hover {
	text-decoration: underline;
}

a:focus,
input:focus,
select:focus,
textarea:focus {
	outline: 1px solid -webkit-focus-ring-color;
	outline-offset: -1px;
}

hr {
	border: 0;
	height: 2px;
	border-bottom: 2px solid;
}

h1 {
	padding-bottom: 0.3em;
	line-height: 1.2;
	border-bottom-width: 1px;
	border-bottom-style: solid;
}

h1, h2, h3 {
	font-weight: normal;
}

table {
	border-collapse: collapse;
}

table > thead > tr > th {
	text-align: left;
	border-bottom: 1px solid;
}

table > thead > tr > th,
table > thead > tr > td,
table > tbody > tr > th,
table > tbody > tr > td {
	padding: 5px 10px;
}

table > tbody > tr + tr > td {
	border-top: 1px solid;
}

blockquote {
	margin: 0 7px 0 5px;
	padding: 0 16px 0 10px;
	border-left-width: 5px;
	border-left-style: solid;
}

code {
	font-family: Menlo, Monaco, Consolas, "Droid Sans Mono", "Courier New", monospace, "Droid Sans Fallback";
	font-size: 1em;
	line-height: 1.357em;
}

body.wordWrap pre {
	white-space: pre-wrap;
}

pre:not(.hljs),
pre.hljs code > div {
	padding: 16px;
	border-radius: 3px;
	overflow: auto;
}

pre code {
	color: var(--vscode-editor-foreground);
	tab-size: 4;
}

/** Theming */

.vscode-light pre {
	background-color: rgba(220, 220, 220, 0.4);
}

.vscode-dark pre {
	background-color: rgba(10, 10, 10, 0.4);
}

.vscode-high-contrast pre {
	background-color: rgb(0, 0, 0);
}

.vscode-high-contrast h1 {
	border-color: rgb(0, 0, 0);
}

.vscode-light table > thead > tr > th {
	border-color: rgba(0, 0, 0, 0.69);
}

.vscode-dark table > thead > tr > th {
	border-color: rgba(255, 255, 255, 0.69);
}

.vscode-light h1,
.vscode-light hr,
.vscode-light table > tbody > tr + tr > td {
	border-color: rgba(0, 0, 0, 0.18);
}

.vscode-dark h1,
.vscode-dark hr,
.vscode-dark table > tbody > tr + tr > td {
	border-color: rgba(255, 255, 255, 0.18);
}

</style>

<style>
/* Tomorrow Theme */
/* http://jmblog.github.com/color-themes-for-google-code-highlightjs */
/* Original theme - https://github.com/chriskempson/tomorrow-theme */

/* Tomorrow Comment */
.hljs-comment,
.hljs-quote {
	color: #8e908c;
}

/* Tomorrow Red */
.hljs-variable,
.hljs-template-variable,
.hljs-tag,
.hljs-name,
.hljs-selector-id,
.hljs-selector-class,
.hljs-regexp,
.hljs-deletion {
	color: #c82829;
}

/* Tomorrow Orange */
.hljs-number,
.hljs-built_in,
.hljs-builtin-name,
.hljs-literal,
.hljs-type,
.hljs-params,
.hljs-meta,
.hljs-link {
	color: #f5871f;
}

/* Tomorrow Yellow */
.hljs-attribute {
	color: #eab700;
}

/* Tomorrow Green */
.hljs-string,
.hljs-symbol,
.hljs-bullet,
.hljs-addition {
	color: #718c00;
}

/* Tomorrow Blue */
.hljs-title,
.hljs-section {
	color: #4271ae;
}

/* Tomorrow Purple */
.hljs-keyword,
.hljs-selector-tag {
	color: #8959a8;
}

.hljs {
	display: block;
	overflow-x: auto;
	color: #4d4d4c;
	padding: 0.5em;
}

.hljs-emphasis {
	font-style: italic;
}

.hljs-strong {
	font-weight: bold;
}
</style>

<style>
/*
 * Markdown PDF CSS
 */

 body {
	font-family: -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif, "Meiryo";
	padding: 0 12px;
}

pre {
	background-color: #f8f8f8;
	border: 1px solid #cccccc;
	border-radius: 3px;
	overflow-x: auto;
	white-space: pre-wrap;
	overflow-wrap: break-word;
}

pre:not(.hljs) {
	padding: 23px;
	line-height: 19px;
}

blockquote {
	background: rgba(127, 127, 127, 0.1);
	border-color: rgba(0, 122, 204, 0.5);
}

.emoji {
	height: 1.4em;
}

code {
	font-size: 14px;
	line-height: 19px;
}

/* for inline code */
:not(pre):not(.hljs) > code {
	color: #C9AE75; /* Change the old color so it seems less like an error */
	font-size: inherit;
}

/* Page Break : use <div class="page"/> to insert page break
-------------------------------------------------------- */
.page {
	page-break-after: always;
}

</style>

<script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
</head>
<body>
  <script>
    mermaid.initialize({
      startOnLoad: true,
      theme: document.body.classList.contains('vscode-dark') || document.body.classList.contains('vscode-high-contrast')
          ? 'dark'
          : 'default'
    });
  </script>
<h2 id="nirbhay-sharma-b19cse114">Nirbhay Sharma (B19CSE114)</h2>
<h2 id="deep-learning---assignment--2">Deep Learning - Assignment -2</h2>
<hr>
<p><strong>Que -1</strong>. code for multiclass svm's + finetuning of RESNET50 and all other evaluation matrix from scratch is provided in the given .ipynb file</p>
<p><em>part-1</em>. the results are given below:</p>
<ul>
<li>accuracy on test set for multiclass svm - $0.697$</li>
<li>confusion_matrix and roc_curve on test set:</li>
</ul>
<!-- ![cm](cm.svg) -->
<p><span> <img src='cm.svg' alt='cm' height='300' width='300'/> <img src='ROC_que2_part1.svg' alt='cm' height='305' width='310'/> <span/></p>
<!-- ![roc](ROC_que2_part1.svg) -->
<p><em>part-2</em>. <strong><code>[bonus]</code></strong></p>
<ul>
<li>comparison</li>
</ul>
<table>
<thead>
<tr>
<th></th>
<th>accuracy</th>
<th>classwise accuracy</th>
<th>confusion_matrix</th>
</tr>
</thead>
<tbody>
<tr>
<td>before finetuning</td>
<td>$0.09$</td>
<td>[0.12, 0.30, 0, 0, 0.36, 0, 0, 0, 0.1, 0]</td>
<td><img src="cm_bf.svg" alt="cmbf"></td>
</tr>
<tr>
<td>after finetuning</td>
<td>$0.90$</td>
<td>[0.92, 0.91, 0.94, 0.86, 0.84, 0.89, 0.90, 0.94, 0.92, 0.90]</td>
<td><img src="cm_af.svg" alt="cmaf"></td>
</tr>
</tbody>
</table>
<ul>
<li>loss_accuracy and roc_curve curve after finetuning of resnet50</li>
</ul>
<p><span> <img src='loss_acc_que2.svg' alt='cm' height='300' width='300'/> <img src='ROC_que2_part2.svg' alt='cm' height='300' width='300'/> <span/></p>
<p><strong>Que-2</strong>. code for the evaluation and training of models is given in .py and .ipynb files</p>
<ul>
<li>comparison among 4 metrics (accuracy, precision, recall, f_score) with various experiments on densenet121 and resnet18</li>
</ul>
<table>
<thead>
<tr>
<th>Model</th>
<th>Loss_function</th>
<th>accuracy</th>
<th>precision</th>
<th>recall</th>
<th>f_score</th>
</tr>
</thead>
<tbody>
<tr>
<td>Densenet121</td>
<td>triplet_loss + Crossentropy</td>
<td>$0.470$</td>
<td>$0.495$</td>
<td>$0.469$</td>
<td>$0.462$</td>
</tr>
<tr>
<td>Densenet121</td>
<td>cross_entropy_loss</td>
<td>$0.478$</td>
<td>$0.501$</td>
<td>$0.478$</td>
<td>$0.476$</td>
</tr>
<tr>
<td>Resnet18</td>
<td>triplet_loss + SVM</td>
<td>$0.326$</td>
<td>$0.318$</td>
<td>$0.326$</td>
<td>$0.318$</td>
</tr>
<tr>
<td>Resnet18</td>
<td>cross_entropy_loss</td>
<td>$0.438$</td>
<td>$0.450$</td>
<td>$0.438$</td>
<td>$0.434$</td>
</tr>
<tr>
<td>Resnet18</td>
<td>center_loss</td>
<td>$0.431$</td>
<td>$0.454$</td>
<td>$0.431$</td>
<td>$0.432$</td>
</tr>
</tbody>
</table>
<ul>
<li>various experiments has been performed using densenet121 and resnet18 with tinyimagenet data on various loss functions and techniques. first thing to observe is that densenet121 has higher metrics (accuracy, precision, recall, f_score) possible reason may be because it has a very dense network and also it utilizes the skip connections, so it would be able to learn better.</li>
<li>densenet121 is trained on combination of triplet-loss and cross-entropy-loss, so due to triplet loss it learns to identify features well and due to cross-entropy-loss it learns to assign classes to the embeddings.</li>
<li>resnet18 is also trained using triplet-loss and SVM, first triplet-loss is used to train the network for embeddings and then SVM is used to train the embeddings against classes</li>
<li>resnet18 is also trained on combination of center-loss and cross-entropy-loss, again cross-entropy-loss is to train models against ground truth labels</li>
<li>On comparing resnet18 in terms of all the losses, we can observe that it gives best performance in case of cross_entropy_loss, possible reason may be that triplet-loss and center-loss may require more epochs of training ($\sim 200$), only after that much huge number of epochs it should be able to separate the classes well and then it would also increase the performance of model in correct classification.</li>
</ul>
<p><strong>Que-3</strong>. code for the comparison is given in .py file</p>
<ul>
<li>comparison among all the 4 optimizers in terms of loss function</li>
</ul>
<img id="img_loss" src='cnn_optim_que3.svg' alt='cm' height='300' width='300'/>
<!-- ![comp](cnn_optim_que3.svg) -->
<ul>
<li>comparison in terms of accuracy</li>
</ul>
<table>
<thead>
<tr>
<th>optimizer</th>
<th>test_accuracy</th>
<th>train_accuracy</th>
</tr>
</thead>
<tbody>
<tr>
<td>vanilla sgd</td>
<td>$0.684$</td>
<td>$0.953$</td>
</tr>
<tr>
<td>minibatch + sgd</td>
<td>$0.838$</td>
<td>$0.861$</td>
</tr>
<tr>
<td>minibatch sgd + momentum</td>
<td>$0.880$</td>
<td>$0.920$</td>
</tr>
<tr>
<td>minibatch + adam</td>
<td>$0.885$</td>
<td>$0.951$</td>
</tr>
</tbody>
</table>
<p>we can see in <a href='#img_loss'>loss_figure</a> that the loss for vanilla sgd and MiniBatch (MB) + Adam decreases loss more as compared to MB sgd or MB with momentum but accuracy wise if we see, then best accuracy is achieved by MB with adam and also we can observe that minibatch sgd with momentum also performs equivalent to MB + adam, vanilla sgd does not perform well in terms of accuracy possibly because batch size here is 1 so it would not be able to learn the distribution well rather it memorize the distriubution (overfitting), MB + sgd on the other hand performs well as it utilize minibatch so it may learn the distribution well.</p>
<hr>
<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({ tex2jax: {inlineMath: [['$', '$']]}, messageStyle: "none" });
</script>

</body>
</html>
